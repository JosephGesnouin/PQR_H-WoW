<?xml version="1.0" encoding="utf-8" ?><WARLOCK><Ability><Name>-- Hotkeys --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Pause/the/rotation!

if not leftkeydown then leftkeydown = 0 end

if IsLeftControlKeyDown()  and GetTime() - leftkeydown &amp;gt; 1 then
	leftkeydown = GetTime()

  	if StopRota  then 

    		StopRota  = false 
		print(&amp;quot;Rotation reenabled!&amp;quot;)

  	else 
    	
		StopRota  = true 
		print(&amp;quot;Rotation stopped!&amp;quot;)

  	end
end

--Pause/the/rotation!

if not rightkeydown then rightkeydown = 0 end

if IsRightControlKeyDown()  and GetTime() - rightkeydown &amp;gt; 1 then
	leftkeydown = GetTime()

  	if UseCD  then 

    		UseCD  = false 
		print(&amp;quot;Cooldowns disabled!&amp;quot;)

  	else 
    	
		UseCD  = true 
		print(&amp;quot;Cooldowns enabled!&amp;quot;)

  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Start Fight --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if StopRota
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;)
or IsMounted()
or UnitChannelInfo(&amp;quot;player&amp;quot;) ~= nil
or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
or UnitBuff(&amp;quot;player&amp;quot;, &amp;quot;Drink&amp;quot;)
or UnitBuff(&amp;quot;player&amp;quot;, &amp;quot;Food&amp;quot;)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Offensive Spells --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
or ( not UnitAffectingCombat(&amp;quot;target&amp;quot;) and not UnitIsPlayer(&amp;quot;target&amp;quot;) )
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Fluch der Verdammnis</Name><Default>false</Default><SpellID>47867</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;,47867, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Fluch der Verdammnis&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Chaosblitz</Name><Default>false</Default><SpellID>59172</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Chaosblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(59172) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Feuerbrunst</Name><Default>false</Default><SpellID>17962</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Verbrennen&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Verbrennen</Name><Default>false</Default><SpellID>47838</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Verbrennen&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47838) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Teufelsrüstung</Name><Default>false</Default><SpellID>47893</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,47893) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>USE: Mouseover Skill</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitAffectingCombat(&amp;quot;player&amp;quot;) and IsMouseButtonDown()
	then RunMacroText(&amp;quot;/click &amp;quot;..GetMouseFocus():GetName()) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Aderlass</Name><Default>false</Default><SpellID>57946</SpellID><Actions></Actions><Lua>if 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;) &amp;lt;= 20
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;gt;= 50
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Todesmantel</Name><Default>false</Default><SpellID>47860</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt;= 50
and IsSpellInRange(&amp;quot;Todesmantel&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Seele brechen</Name><Default>false</Default><SpellID>29858</SpellID><Actions></Actions><Lua>if UnitThreatSituation(&amp;quot;player&amp;quot;) == 3
and GetItemCount(&amp;quot;Seelensplitter&amp;quot;) &amp;gt;= 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Feuerstein herstellen</Name><Default>false</Default><SpellID>60220</SpellID><Actions></Actions><Lua>if GetItemCount(&amp;quot;Großartiger Feuerstein&amp;quot;) == 0
and GetItemCount(&amp;quot;Seelensplitter&amp;quot;) &amp;gt;= 1
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(60220) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Feuerstein</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,enchant,_,_,_,_,_,_ = GetWeaponEnchantInfo()

if enchant == nil
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(55158) == false
and GetItemCount(&amp;quot;Großartiger Feuerstein&amp;quot;) &amp;gt;= 1
then
    UseItemByName(&amp;quot;Großartiger Feuerstein&amp;quot;,&amp;quot;player&amp;quot;) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>USE: Trinket 1</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,cd,havecd = GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13)
if cd == 0 and havecd == 1  
and UnitChannelInfo(&amp;quot;player&amp;quot;) == nil
and UnitCastingInfo(&amp;quot;player&amp;quot;) == nil
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitLevel(&amp;quot;target&amp;quot;) == -1
then 
  UseInventoryItem(13) 
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Fluch der Elemente</Name><Default>false</Default><SpellID>47865</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;, 60433) == nil
and UnitDebuffID(&amp;quot;target&amp;quot;, 51161) == nil
and UnitDebuffID(&amp;quot;target&amp;quot;,47865) == nil
and IsSpellInRange(&amp;quot;Fluch der Elemente&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Fluch der Pein</Name><Default>false</Default><SpellID>47864</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;,47864, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Fluch der Pein&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Aderlass (Buff)</Name><Default>false</Default><SpellID>1454</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 63321) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Schattenblitz (Debuff)</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 17800) == nil
and IsSpellInRange(&amp;quot;Schattenblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then
    RunMacroText(&amp;quot;/use Dämonische Energie&amp;quot;)
    RunMacroText(&amp;quot;/script UIErrorsFrame:Clear()&amp;quot;)
return true end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Feuerbrand</Name><Default>false</Default><SpellID>47811</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;,47811, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Feuerbrand&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47811) == false
then return true end</Lua><RecastDelay>1000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Seelenfeuer D</Name><Default>false</Default><SpellID>47825</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,63167)
and IsSpellInRange(&amp;quot;Seelenfeuer&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47825) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo/Affli: Verderbnis</Name><Default>false</Default><SpellID>47813</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47813, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Verbrennen&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Seelenfeuer GK/D</Name><Default>false</Default><SpellID>47825</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,71165)
and UnitBuffID(&amp;quot;player&amp;quot;,63167)
and IsSpellInRange(&amp;quot;Seelenfeuer&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47825) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Verbrennen</Name><Default>false</Default><SpellID>47838</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,71165)
and PQR_IsCastingSpell(47838) == false
and IsSpellInRange(&amp;quot;Verbrennen&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Schattenblitz</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Schattenblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then
    RunMacroText(&amp;quot;/use Dämonische Energie&amp;quot;)
    RunMacroText(&amp;quot;/script UIErrorsFrame:Clear()&amp;quot;)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Metamorphose</Name><Default>false</Default><SpellID>47241</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,63167)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Zauberstein</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,enchant,_,_,_,_,_,_ = GetWeaponEnchantInfo()

if enchant == nil
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(55194) == false
and GetItemCount(&amp;quot;Großartiger Zauberstein&amp;quot;) &amp;gt;= 1
then
    UseItemByName(&amp;quot;Großartiger Zauberstein&amp;quot;,&amp;quot;player&amp;quot;) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Zauberstein herstellen</Name><Default>false</Default><SpellID>47888</SpellID><Actions></Actions><Lua>if GetItemCount(&amp;quot;Großartiger Zauberstein&amp;quot;) == 0
and GetItemCount(&amp;quot;Seelensplitter&amp;quot;) &amp;gt;= 1
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(47888) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Teufelswache</Name><Default>false</Default><SpellID>30146</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(30146) == false
and GetItemCount(&amp;quot;Seelensplitter&amp;quot;) &amp;gt;= 1
then 
    if UnitAffectingCombat(&amp;quot;player&amp;quot;)
    then
        RunMacroText(&amp;quot;/use Teufelsbeherrschung&amp;quot;)
    end
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Seelenverbindung</Name><Default>false</Default><SpellID>19028</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 35706)
and UnitBuffID(&amp;quot;player&amp;quot;, 19028) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Feuerbrandaura</Name><Default>false</Default><SpellID>50589</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 47241)
and IsSpellInRange(&amp;quot;Schattenspalten&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then
    RunMacroText(&amp;quot;/use Schattenspalten&amp;quot;)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Wichtel</Name><Default>false</Default><SpellID>688</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(688) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Saat der Verderbnis</Name><Default>false</Default><SpellID>47836</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Saat der Verderbnis&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47836) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Heimsuchung</Name><Default>false</Default><SpellID>59164</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Heimsuchung&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(59164) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Instabiles Gebrechen</Name><Default>false</Default><SpellID>47843</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47843, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Instabiles Gebrechen&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47843) == false
then return true end</Lua><RecastDelay>1000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Fluch der Pein</Name><Default>false</Default><SpellID>47864</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47864, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Schattenblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Schattenblitz</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Schattenblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Schattenblitz (Debuff)</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 17800) == nil
and IsSpellInRange(&amp;quot;Schattenblitz&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then return true end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Seelendieb</Name><Default>false</Default><SpellID>8288</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;) &amp;lt;= 25
and IsSpellInRange(&amp;quot;Seelendieb&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(8288) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Teufelsjäger</Name><Default>false</Default><SpellID>691</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(691) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Firestone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,enchant,_,_,_,_,_,_ = GetWeaponEnchantInfo()

if enchant == nil
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(55158) == false
and GetItemCount(&amp;quot;Grand Firestone&amp;quot;) &amp;gt;= 1
then
    UseItemByName(&amp;quot;Grand Firestone&amp;quot;,&amp;quot;player&amp;quot;) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Create Firestone</Name><Default>false</Default><SpellID>60220</SpellID><Actions></Actions><Lua>if GetItemCount(&amp;quot;Grand Firestone&amp;quot;) == 0
and GetItemCount(&amp;quot;Soul Shard&amp;quot;) &amp;gt;= 1
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(60220) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Fel Armor</Name><Default>false</Default><SpellID>47893</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,47893) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Imp</Name><Default>false</Default><SpellID>688</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(688) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Felhunter</Name><Default>false</Default><SpellID>691</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(691) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Death Coil</Name><Default>false</Default><SpellID>47860</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt;= 50
and IsSpellInRange(&amp;quot;Death Coil&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Life Tap</Name><Default>false</Default><SpellID>57946</SpellID><Actions></Actions><Lua>if 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;) &amp;lt;= 20
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;gt;= 50
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Curse of Doom</Name><Default>false</Default><SpellID>47867</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;,47867, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Curse of Doom&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Immolate</Name><Default>false</Default><SpellID>47811</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;,47811, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Immolate&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47811) == false
then return true end</Lua><RecastDelay>1000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Chaos Bolt</Name><Default>false</Default><SpellID>59172</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Chaos Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(59172) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Conflagrate</Name><Default>false</Default><SpellID>17962</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Incinerate&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro: Incinerate</Name><Default>false</Default><SpellID>47838</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Incinerate&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47838) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Destro/Dämo: Curse of the Elements</Name><Default>false</Default><SpellID>47865</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;, 60433) == nil
and UnitDebuffID(&amp;quot;target&amp;quot;, 51161) == nil
and UnitDebuffID(&amp;quot;target&amp;quot;,47865) == nil
and IsSpellInRange(&amp;quot;Curse of the Elements&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Curse of Agony</Name><Default>false</Default><SpellID>47864</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47864, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Shadow Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Haunt</Name><Default>false</Default><SpellID>59164</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Haunt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(59164) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Unstable Affliction</Name><Default>false</Default><SpellID>47843</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47843, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Unstable Affliction&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47843) == false
then return true end</Lua><RecastDelay>1000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Shadow Bolt</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Shadow Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Shadow Bolt (Debuff)</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 17800) == nil
and IsSpellInRange(&amp;quot;Shadow Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then return true end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Drain Soul</Name><Default>false</Default><SpellID>8288</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;) &amp;lt;= 25
and IsSpellInRange(&amp;quot;Drain Soul&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(8288) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Life Tap (Buff)</Name><Default>false</Default><SpellID>1454</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 63321) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Curse of Agony</Name><Default>false</Default><SpellID>47864</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitDebuffID(&amp;quot;target&amp;quot;,47864, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Curse of Agony&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Seed of Corruption</Name><Default>false</Default><SpellID>47836</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Seed of Corruption&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47836) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Soulshatter</Name><Default>false</Default><SpellID>29858</SpellID><Actions></Actions><Lua>if UnitThreatSituation(&amp;quot;player&amp;quot;) == 3
and GetItemCount(&amp;quot;Soul Shard&amp;quot;) &amp;gt;= 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Spellstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,enchant,_,_,_,_,_,_ = GetWeaponEnchantInfo()

if enchant == nil
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(55194) == false
and GetItemCount(&amp;quot;Grand Spellstone&amp;quot;) &amp;gt;= 1
then
    UseItemByName(&amp;quot;Grand Spellstone&amp;quot;,&amp;quot;player&amp;quot;) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All: Create Spellstone</Name><Default>false</Default><SpellID>47888</SpellID><Actions></Actions><Lua>if GetItemCount(&amp;quot;Grand Spellstone&amp;quot;) == 0
and GetItemCount(&amp;quot;Soul Shard&amp;quot;) &amp;gt;= 1
and UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
and PQR_IsCastingSpell(47888) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo/Affli: Corruption</Name><Default>false</Default><SpellID>47813</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 47813, &amp;quot;player&amp;quot;) == nil
and IsSpellInRange(&amp;quot;Incinerate&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Immolation Aura</Name><Default>false</Default><SpellID>50589</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 47241)
and IsSpellInRange(&amp;quot;Shadow Cleave&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then
    RunMacroText(&amp;quot;/use Shadow Cleave&amp;quot;)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Metamorphosis</Name><Default>false</Default><SpellID>47241</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,47893)
and UnitLevel(&amp;quot;target&amp;quot;) == -1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Shadow Bolt</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if IsSpellInRange(&amp;quot;Shadow Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then
    RunMacroText(&amp;quot;/use Demonic Empowerment&amp;quot;)
    RunMacroText(&amp;quot;/script UIErrorsFrame:Clear()&amp;quot;)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Shadow Bolt (Debuff)</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if UnitDebuffID(&amp;quot;target&amp;quot;, 17800) == nil
and IsSpellInRange(&amp;quot;Shadow Bolt&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47809) == false
then
    RunMacroText(&amp;quot;/use Demonic Empowerment&amp;quot;)
    RunMacroText(&amp;quot;/script UIErrorsFrame:Clear()&amp;quot;)
return true end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Felguard</Name><Default>false</Default><SpellID>30146</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(30146) == false
and GetItemCount(&amp;quot;Soul Shard&amp;quot;) &amp;gt;= 1
then 
    if UnitAffectingCombat(&amp;quot;player&amp;quot;)
    then
        RunMacroText(&amp;quot;/use Fel Domination&amp;quot;)
    end
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Incinerate</Name><Default>false</Default><SpellID>47838</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,71165)
and PQR_IsCastingSpell(47838) == false
and IsSpellInRange(&amp;quot;Incinerate&amp;quot;, &amp;quot;target&amp;quot;)  == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Soul Link</Name><Default>false</Default><SpellID>19028</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 35706)
and UnitBuffID(&amp;quot;player&amp;quot;, 19028) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Soul Fire GK/D</Name><Default>false</Default><SpellID>47825</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,71165)
and UnitBuffID(&amp;quot;player&amp;quot;,63167)
and IsSpellInRange(&amp;quot;Soul Fire&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47825) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Soul Fire D</Name><Default>false</Default><SpellID>47825</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,63167)
and IsSpellInRange(&amp;quot;Soul Fire&amp;quot;, &amp;quot;target&amp;quot;)  == 1
and PQR_IsCastingSpell(47825) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Dämo: Demonic Empowerment</Name><Default>false</Default><SpellID>47193</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,47893)
and UnitLevel(&amp;quot;target&amp;quot;) == -1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Affli: Shadow Bolt (Non Cast)</Name><Default>false</Default><SpellID>47809</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 17941)
and PQR_IsCastingSpell(47809) == false
then return true end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability></WARLOCK>